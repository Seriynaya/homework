# Домашняя работа Django REST framework

## Описание:

Этот проект представляет собой работу с DRF

## Использование:

1. Клонируйте репозиторий:
```
https://github.com/Seriynaya/homework.git
```


2. Установление зависимостей:
```
pip install django
```


3. Создайте файл .env в корне проекта и добавьте туда переменные окружения, указанные в файле .env.sample.


4. Подключение к базе данных:
```
[postgres]
host = localhost
port = 5432
user = postgres
password = 5432
```


5. Запуск проекта:
```
Через Docker:
docker compose up -d
Через Python:
python main.py
Подключение к виртуальной машине:
IP - 84.252.134.126
```

6. Проверка работоспособности:
```
Просмотр запущенных контейнеров:
docker-compose ps
Просмотр логов контейнеров:
docker-compose logs
Остановка сервиса и удаление контейнера:
docker-compose down
Сбор образов для сервисов:
docker-compose build
Выполнение команды внутри работающего контейнера:
docker-compose exec
docker push — эта команда загружает образ в ваш репозиторий Docker Hub.
```


## Структура проекта:

1. users/ - приложение для работы с пользователями.
2. materials/ - приложение для работы с курсами и уроками.
3. .github/workflows/ci.yml - папка GitHub Actions для автоматизации задач.

## Структура workflow:

1. name: Check out code — шаг, который клонирует репозиторий с использованием action actions/checkout@v3
2. name: Set up Python — устанавливает Python версии 3.10 с использованием action actions/setup-python@v4
3. name: Install dependencies — устанавливает зависимости из файла requirements.txt. Этот шаг также обновляет pip до последней версии.
4. name: Run migrations — применяет миграции базы данных, что важно для корректного запуска тестов в Django.
5. name: Run tests — запускает тесты проекта с использованием команды python manage.py test
6. deploy — это job для деплоя, запускается только после успешного выполнения тестов (вызвано директивой needs: test).
7. Set up SSH — настройка SSH-подключения с использованием приватного ключа из GitHub Secrets.
8. Copy project files to server — использование rsync для копирования файлов проекта на удаленный сервер, исключая ненужные файлы, такие как__pycache__.
9. Install dependencies on server — установка зависимостей на сервере в виртуальном окружении Python.
10. Apply migrations on server — применение миграций базы данных на сервере.
11. Collect static files on server — сборка и размещение статических файлов на сервере.
12. Restart application — перезапуск сервиса, управляющего вашим приложением, например через systemctl.
13. lint: — название job, отвечает за выполнение линтинга кода.
14. Install dependencies: — устанавливает Flake8 с помощью pip.
15. Run Flake8: — запускает линтер Flake8 на всех Python-файлах в проекте.
16. test: — название job, отвечает за выполнение тестов.
17. Install dependencies: — устанавливает зависимости, указанные в файле requirements.txt.
18. Run migrations: — применяет миграции, чтобы тесты запускались на актуальной базе данных.
19. Run tests: — запускает тесты с помощью Django.

## Деплой для проекта:
Для деплоя Django-приложения необходимо выполнить следующие шаги:

1. Подключение к серверу через SSH.
2. Передача файлов проекта на сервер.
3. Установка зависимостей.
4. Применение миграций базы данных.
5. Сборка статических файлов.
6. Перезапуск сервиса приложения.

## Документация приложения:
Документация проекта доступна по 'swagger/' и 'redoc/'.